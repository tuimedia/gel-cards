var cards=[],allCards;!function(){"use strict";var a=document.querySelectorAll("html");a[0].classList.remove("no-js"),allCards=document.querySelectorAll(".js-card");for(var b=0;b<allCards.length;b++)try{cards[b]=new Cards(allCards[b])}catch(c){"undefined"!=typeof console&&console.error(c.stack)}}();var Cards=function(){"use strict";function a(b){return this instanceof a?(this.card=b,void(this.card&&this.init())):new a(b)}return a.prototype.init=function(a){this.attrs=this.card.dataset,this.card.cardMedia=this.card.querySelectorAll(".card__media")[0],this.card.cardContent=this.card.querySelectorAll(".card__content")[0],this.card.cardToolbar=this.card.querySelectorAll(".card__toolbar")[0],this.card.querySelectorAll(".js-share-cta")[0]&&(this.hasShareCTA=!0,this.share={shareCTA:this.card.querySelectorAll(".js-share-cta")[0],states:{panelOpen:!1}}),this.card.querySelectorAll(".js-poll")[0]&&(this.hasPoll=!0,this.poll={container:this.card.querySelectorAll(".js-poll")[0],options:this.card.querySelectorAll(".js-poll-option"),states:{isAnswered:!1,isCorrect:!1}}),this.card.querySelectorAll(".js-panel")[0]&&this.card.querySelectorAll(".js-more")[0]&&(this.hasPanel=!0,this.panel={container:this.card.querySelectorAll(".js-panel")[0],trigger:this.card.querySelectorAll(".js-more")[0],triggerText:this.card.querySelectorAll(".js-panel-trigger-label")[0],states:{panelOpen:!1}}),this.card.querySelectorAll(".js-gallery")[0]&&(this.hasGallery=!0,this.gallery={container:this.card.querySelectorAll(".js-gallery")[0],images:this.card.querySelectorAll(".js-gallery-img"),next:this.card.querySelectorAll(".js-gallery-next")[0],prev:this.card.querySelectorAll(".js-gallery-prev")[0],play:this.card.querySelectorAll(".js-gallery-play")[0],pause:this.card.querySelectorAll(".js-gallery-pause")[0],close:this.card.querySelectorAll(".js-gallery-close")[0]}),this.card.dataset.cardBgUrl&&(this.hasBackgroundImage=!0,this.card.style.background="url("+this.card.dataset.cardBgUrl+")",this.card.style.backgroundSize="cover"),this.card.querySelectorAll("video")[0]&&(this.hasVideo=!0,this.video={player:this.card.querySelectorAll("video")[0],duration:this.card.querySelectorAll(".js-duration")[0],controls:{play:this.card.querySelectorAll(".js-play")[0],pause:this.card.querySelectorAll(".js-pause")[0],scrubber:this.card.querySelectorAll(".js-scrubber")[0],progress:this.card.querySelectorAll(".js-progress")[0],poster:this.card.querySelectorAll(".js-poster")[0],volume:this.card.querySelectorAll(".js-volume")[0],volumeBar:this.card.querySelectorAll(".js-volume-bar")[0],volumeLevel:this.card.querySelectorAll(".js-volume-level")[0],fullscreen:this.card.querySelectorAll(".js-full-screen")[0]},states:{isPlaying:!1,isFinished:!1,isMuted:!1,isFullscreen:!1}}),this.bindEvents()},a.prototype.handleGallery=function(a){function b(){e.gallery.isAutoplaying=!0,f=setInterval(function(){d("next",e.gallery.images)},3e3)}function c(){clearInterval(f)}function d(a,b){for(var c=0;c<b.length;c++)switch(a){case"next":if(b[c].classList.contains("is-active")&&c<b.length-1)return b[c].classList.remove("is-active"),void b[c+1].classList.add("is-active");if(b[c].classList.contains("is-active")&&c===b.length-1)return b[c].classList.remove("is-active"),void b[0].classList.add("is-active");break;case"prev":if(b[c].classList.contains("is-active")&&0===c)return b[c].classList.remove("is-active"),void b[b.length-1].classList.add("is-active");b[c].classList.contains("is-active")&&c>0&&(b[c].classList.remove("is-active"),b[c-1].classList.add("is-active"))}}var e=this;switch(a){case"prev":this.gallery.isAutoplaying&&c(),d("prev",this.gallery.images);break;case"next":this.gallery.isAutoplaying&&c(),d("next",this.gallery.images);break;case"play":b();break;case"pause":this.isAutoplaying&&c();break;case"close":}var f},a.prototype.bindEvents=function(){var a=this;this.hasGallery&&(this.gallery.prev.addEventListener("click",function(b){a.handleGallery("prev")},!1),this.gallery.next.addEventListener("click",function(b){a.handleGallery("next")},!1),this.gallery.play.addEventListener("click",function(b){a.handleGallery("play")},!1),this.gallery.pause.addEventListener("click",function(b){a.handleGallery("pause")},!1),this.gallery.close.addEventListener("click",function(b){a.handleGallery("close")},!1)),this.hasShareCTA&&this.share.shareCTA.addEventListener("click",function(b){a.handleSharePanel()}),this.hasVideo&&(this.video.controls.play.addEventListener("click",function(b){a.checkActiveVideos()},!1),this.video.controls.poster.addEventListener("click",function(b){a.video.player.paused&&a.checkActiveVideos()},!1),this.video.controls.pause.addEventListener("click",function(b){b.stopPropagation(),a.handleVideo("pause")},!1),this.video.controls.volume.addEventListener("click",function(b){a.handleVideo("volume")},!1),this.video.controls.volumeBar.addEventListener("click",function(b){b.stopPropagation();var c=100*(b.offsetX/a.video.controls.volumeBar.clientWidth),d=parseFloat(b.offsetX/a.video.controls.volumeBar.clientWidth).toFixed(1);a.video.controls.volumeLevel.style.width=c+"%",a.video.player.volume=d},!1),this.video.controls.fullscreen&&this.video.controls.fullscreen.addEventListener("click",function(b){a.handleVideo("fullscreen")},!1),this.video.controls.scrubber.addEventListener("click",function(b){var c=a.video.player.duration*(b.offsetX/a.video.controls.scrubber.offsetWidth);a.video.player.currentTime=c},!1),this.video.player.addEventListener("canplay",function(b){4===a.video.player.readyState&&(a.video.duration.innerText=parseInt(a.video.player.duration/60)%60+" mins")},!1),this.video.player.addEventListener("playing",function(a){},!1),this.video.player.addEventListener("ended",function(b){a.handleVideo("ended")},!1),this.video.player.addEventListener("timeupdate",function(b){var c=100/a.video.player.duration*a.video.player.currentTime;a.video.controls.progress.style.width=c+"%"},!1)),this.hasPanel&&this.panel.trigger.addEventListener("click",function(b){a.handleMoreInfoPanel(this)})},a.prototype.showSharePanel=function(){this.share.panelOpen=!0},a.prototype.hideSharePanel=function(){this.share.panelOpen=!1},a.prototype.handleSharePanel=function(){this.share.panelOpen?this.hideSharePanel():this.showSharePanel(),this.card.classList.toggle("share-panel-active")},a.prototype.showMoreInfoPanel=function(){this.panel.panelOpen=!0,this.panel.triggerText.innerText="Close",this.card.cardContent.style.transform="translateY(-"+this.card.cardMedia.clientHeight+"px)",this.panel.container.style.transform="translateY(-"+this.card.cardMedia.clientHeight+"px)"},a.prototype.hideMoreInfoPanel=function(){this.panel.panelOpen=!1,this.panel.triggerText.innerText="More info",this.card.cardContent.style.transform="translateY(0px)",this.panel.container.style.transform="translateY(0px)"},a.prototype.handleMoreInfoPanel=function(a){this.panel.panelOpen?this.hideMoreInfoPanel():this.showMoreInfoPanel(),this.card.classList.toggle("is-active")},a.prototype.checkActiveVideos=function(){for(var a=0;a<allCards.length;a++){var b=allCards[a].querySelectorAll("video")[0];b&&!b.paused&&(b.pause(),allCards[a].classList.toggle("is-playing"))}this.handleVideo("play")},a.prototype.handleVideo=function(a){switch(a){case"play":this.video.player.play(),this.card.classList.toggle("is-playing"),this.video.states.isPlaying=!0;break;case"pause":this.video.player.pause(),this.card.classList.toggle("is-playing"),this.video.states.isPlaying=!1;break;case"volume":this.video.player.muted=this.video.player.muted===!0?!1:!0,this.card.classList.toggle("is-muted"),this.video.states.isMuted=this.video.player.muted===!0?!1:!0;break;case"fullscreen":this.video.player.requestFullscreen?this.video.player.requestFullscreen():this.video.player.msRequestFullscreen?this.video.player.msRequestFullscreen():this.video.player.mozRequestFullScreen?this.video.player.mozRequestFullScreen():this.video.player.webkitRequestFullscreen&&this.video.player.webkitRequestFullscreen();break;case"ended":this.card.classList.remove("is-playing"),this.video.player.load()}},a}();